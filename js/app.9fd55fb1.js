(function(e){function t(t){for(var n,a,s=t[0],c=t[1],l=t[2],d=0,u=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&u.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);h&&h(t);while(u.length)u.shift()();return i.push.apply(i,l||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,a=1;a<o.length;a++){var c=o[a];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=o[0]))}return e}var n={},r={app:0},i=[];function a(e){return s.p+"js/"+({about:"about"}[e]||e)+"."+{about:"87cf35ae"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(e){var t=[],o=r[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,n){o=r[e]=[t,n]}));t.push(o[2]=n);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=a(e);var l=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(d);var o=r[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",l.name="ChunkLoadError",l.type=n,l.request=i,o[1](l)}r[e]=void 0}};var d=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var h=l;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"2c75":function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("cadf"),o("551c"),o("f751"),o("097d");var n,r,i=o("2b0e"),a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("div",{attrs:{id:"nav"}},[o("router-link",{attrs:{to:"/"}},[e._v("Play")]),e._v(" |\n    "),o("router-link",{attrs:{to:"/about"}},[e._v("About")])],1),o("router-view"),e._m(0)],1)},s=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("footer",[e._v("made by "),o("a",{attrs:{href:"//rabol.co"}},[e._v("Frederik RabÃ¸l")])])}],c=(o("5c0b"),o("c7e8"),o("2877")),l={},d=Object(c["a"])(l,a,s,!1,null,"8ecb8a5e",null),h=d.exports,u=o("8c4f"),p=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("basic-map")},f=[],m=(o("456d"),o("ac6a"),o("5a89")),v=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"map",attrs:{id:"map"}},[o("header",[o("span",[e._v("Coordinates")]),o("span",[e._v("X: "+e._s(e.mouse.x))]),o("span",[e._v("Y: "+e._s(e.mouse.y))]),o("span",[e._v(e._s(this.plates.length-1)+" Blocks")]),o("span",[e._v("Color")]),o("ul",{staticClass:"colors"},e._l(e.colors,(function(t,n){return o("li",{key:n,class:{selected:e.selectedColor===t},style:{backgroundColor:t},on:{click:function(t){e.selectedColor=e.colors[n]}}})})),0),o("span",[e._v("Type")]),o("ul",{staticClass:"type"},e._l(e.blockTypes,(function(t,n){return o("li",{key:n,class:{selected:e.selectedType===t},domProps:{textContent:e._s(t)},on:{click:function(t){e.selectedType=e.blockTypes[n]}}})})),0)]),o("footer",[o("strong",[e._v("controls")]),e._l(e.controls,(function(t,n){return o("span",{key:n},[e._v("\n\t\t\t"+e._s(Object.keys(t)[0])+" : "+e._s(Object.values(t)[0])+"\n\t\t")])}))],2)])},w=[],g=o("6397"),y=o.n(g),b={mounted:function(){this.container=this.$refs.map,this.containerSize=this.container.getBoundingClientRect(),this.mouse=new m["Vector3"](0,0,1),this.selectedColor=this.colors[0],this.setupClock(),this.setupScene(),this.setupRenderer(this.container),this.setupCamera(),this.calculateFOV(),this.addGrid(),this.addHelperPosition(),this.addRaycaster(),this.addControls(),this.addStartupFloor(),this.container.appendChild(this.Renderer.domElement),this.startAnimationFrames()},data:function(){return{FOV:{},scene:{},Renderer:{},camera:{},GridHelper:{},container:{},clock:{},helperPosition:{},containerSize:{},perspectiveFar:101,perspectiveNear:0,rollOverMaterial:{},rollOverMesh:{},mouse:{},gridFloor:{},plates:[],raycaster:{},controls:[],colors:["#50822D","#4B94CC","#6B4F41","#EDDDB4","#7A7A7A","#FAA381"],selectedColor:"",blockTypes:["block","slab","column","torch"],selectedType:"block"}},methods:{addStartupFloor:function(){var e=this,t=new m["MeshToonMaterial"]({color:this.colors[0]});t.receiveShadow=!0;var o=new m["BoxGeometry"](16,16,16),n=[new m["Vector3"](-8,-8,8),new m["Vector3"](8,-8,8)];n.forEach((function(n){var r=new m["Mesh"](o,t);r.position.copy(n),e.scene.add(r)}))},addControls:function(){this.controls.push({G:"Toggle grid"},{S:"save game"},{L:"load latest saved game"})},calculateFOV:function(){this.FOV=Math.tan(Math.PI/180*this.camera.fov/2)},setupClock:function(){this.clock=new m["Clock"]},setupScene:function(){this.scene=new m["Scene"],this.scene.background=new m["Color"](16777215),this.scene.position.z=0,this.scene.autoUpdate=!0},setupRenderer:function(){this.Renderer=new m["WebGLRenderer"]({alpha:!0}),this.Renderer.setSize(this.containerSize.width,this.containerSize.height),this.Renderer.setPixelRatio(window.devicePixelRatio)},setupCamera:function(){this.camera=new m["PerspectiveCamera"](45,window.innerWidth/window.innerHeight,1,1e4),this.camera.position.set(0,0,10),this.camera.zoom=this.maxZoom/2,this.scene.add(this.camera),this.camera.updateProjectionMatrix(),this.mouse=new m["Vector2"];var e=new y.a(this.camera,this.Renderer.domElement);e.maxPolarAngle=.5*Math.PI,e.minDistance=1e3,e.maxDistance=5e3;var t=new m["HemisphereLight"](16777147,526368,.5);t.position.set(0,50,0),this.scene.add(t);var o=new m["DirectionalLight"](16777215,.75);o.position.set(-10,20,40),this.scene.add(o),o.position.multiplyScalar(30)},addGrid:function(){this.GridHelper=new m["GridHelper"](1024,64),this.GridHelper.rotation.x=1.570795,this.GridHelper.z=1,this.scene.add(this.GridHelper);var e=new m["PlaneBufferGeometry"](1024,1024);this.gridFloor=new m["Mesh"](e,new m["MeshBasicMaterial"]({visible:!1})),this.scene.add(this.gridFloor),this.plates.push(this.gridFloor)},addHelperPosition:function(){var e=new m["BoxBufferGeometry"](16,16,16);this.rollOverMaterial=new m["MeshToonMaterial"]({color:"blue",transparent:!0,opacity:.5}),this.rollOverMesh=new m["Mesh"](e,this.rollOverMaterial),this.scene.add(this.rollOverMesh)},addRaycaster:function(){this.raycaster=new m["Raycaster"]},startAnimationFrames:function(){var e=this,t=function t(){requestAnimationFrame(t);var o=e,n=o.clock.getDelta();e.plates.forEach((function(e){e.hasOwnProperty("mixer")&&e.mixer.update(n)})),e.render()};this.render(),t()},render:function(){this.Renderer.render(this.scene,this.camera)}}},S=b,k=(o("b545"),Object(c["a"])(S,v,w,!1,null,"356e86d7",null)),x=k.exports,M={extends:x,mounted:function(){var e=this;window.onload=this.addListeners(),setInterval((function(){e.saveGame()}),3e5)},data:function(){return{minZoom:20,maxZoom:10,gridEnabled:!0}},methods:{addListeners:function(){this.$refs.map.addEventListener("mousedown",this.mouseDown,!1),window.addEventListener("mouseup",this.mouseUp,!1),this.$refs.map.addEventListener("wheel",this.zoom,!1),this.$refs.map.addEventListener("mousedown",this.click,!1),this.$refs.map.addEventListener("resize",this.onWindowResize,!1),document.addEventListener("mousemove",this.mouseMove,!1),document.addEventListener("keydown",this.keyDown,!1)},mouseUp:function(){window.removeEventListener("mousemove",this.divMove,!0)},mouseDown:function(){window.addEventListener("mousemove",this.divMove,!0)},divMove:function(e){this.camera.position.x+=-e.movementX/this.camera.zoom,this.camera.position.y+=e.movementY/this.camera.zoom},zoom:function(e){e.preventDefault();var t=2;if(e.deltaY>0){if(this.camera.zoom===this.minZoom)return;this.camera.zoom-=t}else{if(this.camera.zoom===this.maxZoom)return;this.camera.zoom+=t}this.camera.updateProjectionMatrix()},onWindowResize:function(){this.containerSize=this.container.getBoundingClientRect(),this.camera.aspect=this.containerSize.width/this.containerSize.height,this.camera.fov=360/Math.PI*Math.atan(this.FOV*(this.containerSize.width/this.containerSize.height)),this.camera.lookAt(new m["Vector3"](0,0,0)),this.Renderer.setSize(this.containerSize.width,this.containerSize.height),this.camera.updateProjectionMatrix(),this.render()},mouseMove:function(e){e.preventDefault(),this.mouse.set(e.clientX/this.containerSize.width*2-1,-e.clientY/this.containerSize.height*2+1),this.raycaster.setFromCamera(this.mouse,this.camera);var t=this.raycaster.intersectObjects(this.plates);if(t.length>0){var o=t[0];this.rollOverMesh.position.copy(o.point).add(o.face.normal),this.rollOverMesh.position.divideScalar(16).floor().multiplyScalar(16).addScalar(8),this.camera.updateProjectionMatrix()}this.render()},click:function(e){var t=this;e.preventDefault(),this.raycaster.setFromCamera(this.mouse,this.camera);var o=this.raycaster.intersectObjects(this.plates);if(o.length>0){var n=o[0];if(0===e.button){if(n.object!==this.gridFloor){var r=this.plates[this.plates.indexOf(n.object)];this.plates[this.plates.indexOf(n.object)].mixer=new m["AnimationMixer"](n.object);var i=new m["NumberKeyframeTrack"](".material.opacity",[0,1],[1,0]),a=new m["AnimationClip"](null,.25,[i]),s=r.mixer.clipAction(a);s.setLoop(m["LoopOnce"]),s.play(),setTimeout((function(){n.object!==t.gridFloor&&(t.scene.remove(n.object),t.plates.splice(t.plates.indexOf(n.object),1))}),300)}}else 2===e.button&&this.createBlock(n)}this.camera.updateProjectionMatrix()},createBlock:function(e){var t=new m["BoxBufferGeometry"](16,16,16);"slab"===this.selectedType&&(t=new m["BoxBufferGeometry"](16,8,16)),"column"===this.selectedType&&(t=new m["BoxBufferGeometry"](8,16,8)),"torch"===this.selectedType&&(t=new m["BoxBufferGeometry"](4,12,4));var o=new m["Color"](this.selectedColor),n=new m["MeshToonMaterial"]({color:o});n.receiveShadow=!0;var r=new m["Mesh"](t,n);if(r.position.copy(e.point).add(e.face.normal),r.position.divideScalar(16).floor().multiplyScalar(16).addScalar(8),this.scene.add(r),this.plates.push(r),"torch"===this.selectedType){r.position.divideScalar(16).floor().multiplyScalar(16).addScalar(8),console.log(r.position);var i=new m["SphereGeometry"](3,3,2),a=new m["MeshToonMaterial"]({color:"orange",opacity:.5,transparent:!0}),s=new m["Mesh"](i,a);r.add(s),s.position.set(0,8,0)}this.render()},keyDown:function(e){"g"===e.key&&this.toggleGrid(),"s"===e.key&&this.saveGame(),"l"===e.key&&this.loadGame()},toggleGrid:function(){this.gridEnabled=!this.gridEnabled,this.gridEnabled?this.scene.add(this.GridHelper):this.scene.remove(this.GridHelper)},saveGame:function(){var e=Date.now(),t=localStorage.voxels?JSON.parse(localStorage.voxels):{},o=[];this.plates.forEach((function(e){o.push(e.toJSON())})),t[e]=this.plates,localStorage.voxels=JSON.stringify(t)},loadGame:function(){var e=this,t=JSON.parse(localStorage.voxels),o=Object.keys(t),n=o[o.length-1],r=t[n];console.log(n,o.length,o),r.forEach((function(t,o){if(0!==o){var n=new m["ObjectLoader"];n.parse(t,(function(t){e.plates.push(t),e.scene.add(t),console.log()}),(function(e){console.log("".concat(e.loaded/e.total*100,"% loaded"))}),(function(e){console.error("An error happened",e)}))}}))}}},O=M,_=Object(c["a"])(O,n,r,!1,null,null,null),j=_.exports,C={name:"play",components:{basicMap:j}},z=C,E=Object(c["a"])(z,p,f,!1,null,null,null),P=E.exports;i["a"].use(u["a"]);var G=new u["a"]({routes:[{path:"/",name:"play",component:P},{path:"/about",name:"about",component:function(){return o.e("about").then(o.bind(null,"f820"))}}]}),F=o("9483");Object(F["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),i["a"].config.productionTip=!1,new i["a"]({router:G,render:function(e){return e(h)}}).$mount("#app")},"5c0b":function(e,t,o){"use strict";var n=o("e332"),r=o.n(n);r.a},7704:function(e,t,o){},b545:function(e,t,o){"use strict";var n=o("7704"),r=o.n(n);r.a},c7e8:function(e,t,o){"use strict";var n=o("2c75"),r=o.n(n);r.a},e332:function(e,t,o){}});
//# sourceMappingURL=app.9fd55fb1.js.map